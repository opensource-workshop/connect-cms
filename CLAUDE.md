# CLAUDE.md

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€Claude Code (claude.ai/code) ãŒã“ã®ãƒªãƒã‚¸ãƒˆãƒªã®ã‚³ãƒ¼ãƒ‰ã‚’æ“ä½œã™ã‚‹éš›ã®ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Connect-CMSã¯ã€Webã‚µã‚¤ãƒˆã‚’ç°¡å˜ã«ä½œæˆã™ã‚‹ãŸã‚ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚Laravel 8ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ãƒ™ãƒ¼ã‚¹ã«æ§‹ç¯‰ã•ã‚Œã¦ãŠã‚Šã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

## é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

### ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«
```bash
# PHP Code Snifferï¼ˆã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯ï¼‰
composer run phpcs

# PHP Code Beautifier and Fixerï¼ˆã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«è‡ªå‹•ä¿®æ­£ï¼‰
composer run phpcbf

# ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿ã‚’ãƒã‚§ãƒƒã‚¯
composer run phpcs-any -- path/to/file
composer run phpcbf-any -- path/to/file
```

### ãƒ†ã‚¹ãƒˆ
```bash
# ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
php artisan test

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè¡Œä¾‹
php artisan test tests/Unit/Database/Seeders/DefaultConfigsTableSeederTest.php

# PHPUnit ã«ã‚ˆã‚‹ç›´æ¥å®Ÿè¡Œ
composer run phpunit
# ã¾ãŸã¯
./vendor/bin/phpunit

# PHPUnit ã§ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å®Ÿè¡Œ
./vendor/bin/phpunit tests/Feature/SomeTest.php
```

**é‡è¦**: ãƒ†ã‚¹ãƒˆã¯ `php artisan test` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚PHPUnitã®ç›´æ¥å®Ÿè¡Œã‚ˆã‚Šã‚‚Laravelã®æ©Ÿèƒ½ã‚’æ´»ç”¨ã§ãã¾ã™ã€‚

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
```bash
# é–‹ç™ºç’°å¢ƒå‘ã‘ãƒ“ãƒ«ãƒ‰
npm run dev

# æœ¬ç•ªç’°å¢ƒå‘ã‘ãƒ“ãƒ«ãƒ‰
npm run prod

# ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ï¼ˆé–‹ç™ºä¸­ï¼‰
npm run watch
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 
ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã®æ ¸å¿ƒã¯ `app/Plugins/` ã«ã‚ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã™ï¼š

- **User ãƒ—ãƒ©ã‚°ã‚¤ãƒ³**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ©Ÿèƒ½ï¼ˆBlogã€Databaseã€Formsã€Reservationsç­‰ï¼‰
- **Manage ãƒ—ãƒ©ã‚°ã‚¤ãƒ³**: ç®¡ç†æ©Ÿèƒ½ï¼ˆUserManageã€PageManageã€SystemManageç­‰ï¼‰
- **Api ãƒ—ãƒ©ã‚°ã‚¤ãƒ³**: APIæ©Ÿèƒ½
- **Mypage ãƒ—ãƒ©ã‚°ã‚¤ãƒ³**: ãƒã‚¤ãƒšãƒ¼ã‚¸æ©Ÿèƒ½

å„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ `PluginBase` ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ã€ç‹¬è‡ªã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ
- `pages`: ãƒšãƒ¼ã‚¸éšå±¤æ§‹é€ ï¼ˆNested Set Patternï¼‰
- `frames`: ãƒšãƒ¼ã‚¸å†…ã®ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®é…ç½®ã‚¨ãƒªã‚¢ï¼‰
- `buckets`: å„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚³ãƒ³ãƒ†ãƒŠ
- `plugins`: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®è¨­å®šæƒ…å ±

### æ¨©é™ã‚·ã‚¹ãƒ†ãƒ 
- `users_roles`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨æ¨©é™ã®é–¢é€£
- `buckets_roles`: ãƒã‚±ãƒƒãƒˆï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼‰ãƒ¬ãƒ™ãƒ«ã®æ¨©é™
- `page_roles`: ãƒšãƒ¼ã‚¸ãƒ¬ãƒ™ãƒ«ã®æ¨©é™

## é‡è¦ãªè¨­å®š

### PHPã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„
- phpcs.xml ã«å¾“ã£ãŸ PSR-12 æº–æ‹ ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«
- ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã¯ `_` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨
- å¤‰æ•°åã¯ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ï¼ˆä¾‹: `$existing_config_names`ã€`$first_count`ï¼‰ã‚’ä½¿ç”¨

## ä¸»è¦ãªãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

- `app/Plugins/`: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æœ¬ä½“
- `app/Enums/`: åˆ—æŒ™å‹å®šç¾©
- `app/Models/`: Eloquentãƒ¢ãƒ‡ãƒ«
- `database/migrations/`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- `resources/views/plugins/`: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«
- `public/`: å…¬é–‹ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆCSSã€JSã€ç”»åƒç­‰ï¼‰

## é–‹ç™ºæ™‚ã®æ³¨æ„ç‚¹

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™º
æ–°ã—ã„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œæˆã™ã‚‹å ´åˆã¯ã€æ—¢å­˜ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å‚è€ƒã«ã—ã¦ä»¥ä¸‹ã®æ§‹é€ ã«å¾“ã£ã¦ãã ã•ã„ï¼š
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¯ãƒ©ã‚¹ï¼ˆUserPluginBaseç¶™æ‰¿ï¼‰
- ãƒ¢ãƒ‡ãƒ«ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
- ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å¤‰æ›´ã¯å¿…ãšãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
- `created_id`ã€`updated_id` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é©åˆ‡ã«è¨­å®š
- è«–ç†å‰Šé™¤ï¼ˆ`deleted_at`ï¼‰ã‚’é©åˆ‡ã«ä½¿ç”¨

### ãƒ†ã‚¹ãƒˆä½œæˆ
- æ–°æ©Ÿèƒ½ã«ã¯å¯¾å¿œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’ä½œæˆ
- Feature ãƒ†ã‚¹ãƒˆã¨Unit ãƒ†ã‚¹ãƒˆã‚’é©åˆ‡ã«ä½¿ã„åˆ†ã‘
- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ `db-testing` ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨
- ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œã¯ `php artisan test` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨
- å¤‰æ•°åã¯ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹ï¼ˆä¾‹: `$first_count`ã€`$config_name`ï¼‰ã‚’ä½¿ç”¨

## ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥

### GitHub Flow
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯GitHub Flowã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ï¼š

1. **mainãƒ–ãƒ©ãƒ³ãƒ**: å¸¸ã«ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ãªçŠ¶æ…‹ã‚’ä¿ã¤
2. **featureãƒ–ãƒ©ãƒ³ãƒ**: æ–°æ©Ÿèƒ½ã‚„ä¿®æ­£ã¯ `feature/` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã§åˆ†å²
3. **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**:
   - `master` ã‹ã‚‰ `feature/task-name` ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ
   - é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆãƒ»ã‚³ãƒŸãƒƒãƒˆ
   - Pull Requestã‚’ä½œæˆï¼ˆ`feature/task-name` â†’ `master`ï¼‰
   - ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ‰¿èªå¾Œã«ãƒãƒ¼ã‚¸
   - featureãƒ–ãƒ©ãƒ³ãƒã‚’å‰Šé™¤

### Pull Requestãƒ«ãƒ¼ãƒ«
PRã‚’ä½œæˆã™ã‚‹éš›ã¯ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã«**å¿…ãš**å¾“ã£ã¦ãã ã•ã„ï¼š

**ã‚¿ã‚¤ãƒˆãƒ«å½¢å¼**: `[Plugin/Area] å…·ä½“çš„ãªå¤‰æ›´å†…å®¹ã®èª¬æ˜`
- ä¾‹: `[ã‚­ãƒ£ãƒ“ãƒãƒƒãƒˆ] ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã—ãŸ`
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åã‚„ã‚¨ãƒªã‚¢åã‚’è§’æ‹¬å¼§ã§æ˜è¨˜
- ã§ã™ã¾ã™èª¿ã§è¨˜è¿°
- ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã«ä½¿ç”¨ã•ã‚Œã‚‹ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç†è§£ã—ã‚„ã™ã„èª¬æ˜ã«ã™ã‚‹

**PRãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**: `.github/PULL_REQUEST_TEMPLATE.md` ã«å¾“ã£ã¦ä½œæˆ
- æ¦‚è¦: å¤‰æ›´ã®èƒŒæ™¯ãƒ»ç›®çš„ãƒ»å†…å®¹
- ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†å¸Œæœ›æ—¥
- é–¢é€£PR/Issues
- å‚è€ƒæƒ…å ±
- DBå¤‰æ›´ã®æœ‰ç„¡
- ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

è©³ç´°: https://github.com/opensource-workshop/connect-cms/wiki/Pull-requests-Rule

**é‡è¦**: PRã®æœ¬æ–‡ã«ã¯ã€Claudeç”£ã¨ã‚ã‹ã‚‹ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆä¾‹: "ğŸ¤– Generated with Claude Code"ï¼‰ã‚’å«ã‚ãªã„ã“ã¨

## è¨˜éŒ²ã™ã¹ãå†…å®¹

- ç¾åœ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çŠ¶æ…‹ã‚„ã€ä»Šå¾Œã®é–‹ç™ºã§æ³¨æ„ã™ã¹ãç‚¹ã‚’éšæ™‚ãƒ¡ãƒ¢ã™ã‚‹
- ç‰¹ã«ã€è¤‡é›‘ãªå®Ÿè£…ã‚„é‡è¦ãªè¨­è¨ˆåˆ¤æ–­ã®èƒŒæ™¯ã‚’è¨˜éŒ²ã™ã‚‹
- **ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å›ºæœ‰ã®çŸ¥è­˜**: å„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ç‰¹æ®Šãªä»•æ§˜ã¯ç©æ¥µçš„ã«è¨˜éŒ²ã—ã€ä»Šå¾Œã®é–‹ç™ºåŠ¹ç‡åŒ–ã«æ´»ç”¨ã™ã‚‹

## åŠ¹ç‡çš„ãªé–‹ç™ºã®ãŸã‚ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### æ¤œç´¢ã¨ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
- è¤‡æ•°å›ã«ã‚ãŸã‚‹æ¤œç´¢ãŒå¿…è¦ãªå ´åˆã¯ã€Taskãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³æ¶ˆè²»ã‚’å‰Šæ¸›
- è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®åŒæ™‚èª­ã¿è¾¼ã¿ã«ã¯ã€ä¸¦è¡Œã—ã¦Readãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè¡Œ
- ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ãŒåˆ†ã‹ã£ã¦ã„ã‚‹å ´åˆã¯ã€Grepã‚„Globã‚ˆã‚Šã‚‚Readãƒ„ãƒ¼ãƒ«ã‚’ç›´æ¥ä½¿ç”¨

### ã‚³ãƒ¼ãƒ‰å…±é€šåŒ–
- é‡è¤‡ã™ã‚‹ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç™ºè¦‹ã—ãŸå ´åˆã¯ã€DRYåŸå‰‡ã«å¾“ã£ã¦å…±é€šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚„ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’ä½œæˆ
- ç‰¹ã«ãƒ“ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€includeã‚’æ´»ç”¨ã—ãŸéƒ¨åˆ†ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–ã‚’æ¨å¥¨

### ãƒ•ã‚©ãƒ¼ãƒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å›ºæœ‰ã®çŸ¥è­˜
- ãƒ•ã‚©ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã¯ `form`ï¼ˆé€šå¸¸ï¼‰ã¨ `questionnaire`ï¼ˆã‚¢ãƒ³ã‚±ãƒ¼ãƒˆï¼‰ã®2ç¨®é¡
- ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ã¯ `index_tandem.blade.php` ã¨ `forms_confirm_tandem.blade.php` ã‚’ä½¿ç”¨
- Captchaæ©Ÿèƒ½ã¯ `mews/captcha` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã€APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: `/captcha/api/flat`
- å…±é€šã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã¯ `@include('plugins.common.errors_inline', ['name' => 'field_name'])` ã‚’ä½¿ç”¨

## æ³¨æ„ç‚¹

- git commentã«ã¯prefixã‚’ä»˜ã‘ã‚‹

## ç¦æ­¢äº‹é …
- masterãƒ–ãƒ©ãƒ³ãƒã¸ã®commitã¯ç¦æ­¢ã§ã™ã€‚featureãƒ–ãƒ©ãƒ³ãƒã‚’ä½œã‚‹ã“ã¨ã€‚ 
